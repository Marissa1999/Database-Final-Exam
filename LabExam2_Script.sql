--LabExam2_Script.sql:
--Name: Marissa GonÃ§alves
--Date: December 3, 2018


CONNECT scott/tiger
SET LINESIZE 180
SET PAGESIZE 45
SET ECHO ON


START "D:\Marissa\Hockey_DB_Script.sql"
START "D:\Marissa\HockeyPlus_DB_Script.sql";



SPOOL "D:\Semester III\Database I\Exam2\LabExam2_Spool.txt"


--Step A:

DESCRIBE PLAYER;

SELECT * FROM PLAYER;




--Step B:


--Question 1:

SELECT NAME AS "Player Name", TO_CHAR(BIRTHDATE, 'Mon DD, YYYY') AS "Birth Date", GAMESPLAYED AS "Games Played"
FROM PLAYER
WHERE GAMESPLAYED > 1000
ORDER BY BIRTHDATE DESC, GAMESPLAYED ASC;




--Question 2:

SELECT POSITION
FROM PLAYER
GROUP BY POSITION
ORDER BY POSITION ASC;





--Question 3:


SELECT NAME, PENALTY
FROM PLAYER
WHERE PENALTY > 1000 AND PENALTY < 1400
ORDER BY NAME ASC;






--Question 4:

SELECT NAME||' was born in '||BIRTHPLACE AS "Birthplace Information"
FROM PLAYER
WHERE NAME||' was born in '||BIRTHPLACE LIKE 'Martin%PQ';





--Question 5:

SELECT SUM(PENALTY) AS "Total Time for Defense Players"
FROM PLAYER
WHERE POSITION = 'D';






--Question 6:

SELECT COUNT(*) AS "Nb. Players Goals > Assists"
FROM PLAYER
WHERE GOALS > ASSISTS;






--Question 7:

COLUMN GOALSAVERAGE FORMAT 999.99 HEADING "Goals Average"
COLUMN ASSISTSAVERAGE FORMAT 999.99 HEADING "Assists Average"
COLUMN POINTSAVERAGE FORMAT 999.99 HEADING "Points Average"

SELECT ROUND(AVG(GOALS), 2) GOALSAVERAGE, ROUND(AVG(ASSISTS), 2) ASSISTSAVERAGE, ROUND(AVG(POINTS), 2) POINTSAVERAGE
FROM PLAYER
WHERE POSITION <> 'D';






--Question 8:

SELECT NAME, POINTS
FROM PLAYER
WHERE POINTS = (SELECT MAX(POINTS)
                FROM PLAYER);



			  

--Question 9:

SELECT NAME, PENALTY
FROM PLAYER
WHERE PENALTY IN (SELECT PENALTY
                  FROM PLAYER
			      WHERE NAME = 'Ted Green')
ORDER BY NAME;





--Question 10:

SELECT SUM(POINTS) AS "Total Points"
FROM PLAYER
WHERE BIRTHDATE >= TO_DATE('01/01/1960', 'MM/DD/YYYY') AND BIRTHDATE <= TO_DATE('12/31/1969', 'MM/DD/YYYY');





--Question 11:

SELECT ROWNUM, NAME, BIRTHPLACE, POINTS
FROM (SELECT NAME, BIRTHPLACE, POINTS
      FROM PLAYER
	  ORDER BY POINTS DESC)
WHERE ROWNUM <= 4;






--Question 12:

COLUMN AVERAGE FORMAT 999.99 HEADING "Average"
SELECT POSITION, AVG(POINTS) AVERAGE
FROM PLAYER
GROUP BY POSITION
ORDER BY POSITION ASC;







--Question 13:

DESCRIBE PLAYERPLUS;


--Query 1:

SELECT NAME, POSITION, BIRTHDATE, BIRTHPLACE
FROM PLAYER;


--Query 2:

SELECT NAME, POSITION, BIRTHDATE, BIRTHPLACE
FROM PLAYERPLUS;






--Question 14:

SELECT NAME, POSITION, TO_CHAR(BIRTHDATE, 'YY-MM-DD') AS "BIRTHDATE", BIRTHPLACE
FROM PLAYER
INTERSECT
SELECT NAME, POSITION, TO_CHAR(BIRTHDATE, 'YY-MM-DD') AS "BIRTHDATE", BIRTHPLACE
FROM PLAYERPLUS;







--Question 15:

SELECT NAME, POSITION, TO_CHAR(BIRTHDATE, 'YY-MM-DD') AS "BIRTHDATE", BIRTHPLACE
FROM PLAYERPLUS
MINUS
SELECT NAME, POSITION, TO_CHAR(BIRTHDATE, 'YY-MM-DD') AS "BIRTHDATE", BIRTHPLACE
FROM PLAYER;







SPOOL OFF;
